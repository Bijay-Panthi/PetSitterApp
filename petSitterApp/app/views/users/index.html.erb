<h4> <%= @users.length %> PetSitters are available in your area </h4>
<div>
  <div id="map" style="width:400px; height:400px"></div>
  <div>

  <% @users.each do |user| %>
    <div class="listImage">
      <% if user.image %>
        <%= link_to(image_tag(user.image), user_path(user)) %>
      <% else %>
        <%= link_to(user.name, user_path(user)) %>
      <% end %>
    </div>
  <% end %>
  </div>
</div>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAxeAbvMpzSxjfYXVRsxH9F1mmUjiKZ9OU&libraries=visualization"></script>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAxeAbvMpzSxjfYXVRsxH9F1mmUjiKZ9OU&libraries=places"></script>
<script>
      function initMap() {
          var userPos = {
              lat: <%= @users.first.latitude %>,
              lng: <%= @users.first.longitude %>
          };
          // Using markers array from above, saved this to variable
          var locs = <%= @markers.to_json.html_safe %>
          // Create map, rendering to the div with id of map, use userPos as the center
          var map = new google.maps.Map(document.querySelector("#map"), {
              zoom: 12,
              center: userPos
          });
          var locs = [];
          <% @users.each do |user| %>
            locs.push({lat:<%=user.latitude%>, lng:<%=user.longitude%>})
          <% end %>


          for (i = 0; i < locs.length; i++) {
              var marker = new google.maps.Marker({
                  position: new google.maps.LatLng(locs[i].lat, locs[i].lng),
                  map: map
              })
          }
      }
      initMap();
  </script>
